📝 Wiki: 座標系の理解とIDの設計
このアプリケーションでは、シーン内の複数の本棚に規則正しく本を配置し、クリックされた本へ正確にカメラを移動させるために、以下の3つの主要な座標系とID設計を採用しています。

1. グローバル座標系（World Space）
これはThree.js/R3Fシーン全体の基準となる座標系です。

項目	意味	関連定数/ファイル
原点 (0, 0, 0)	シーンの中心点。床の中心など。	App.tsx (<Canvas>の内部)
Y軸	上下方向。	-
X/Z軸	水平な地面方向。	-
本棚の位置	App.tsxで<Bookshelf>に渡されるpositionプロパティ。	BOOKSHELF_OFFSETS (e.g., [-7.5, -5, 0])

2. ローカル座標系（Local Space）
各本棚モデル（Bookshelf.tsx）の内部で使用される座標系です。

原点: 各本棚モデルの中心。

役割: Bookshelf.tsxは、このローカル座標系内で、本棚のメッシュや本（Book.tsx）を配置します。例えば、本棚モデルの「一番上の棚の右端」などの位置は、このローカル座標系で定義されます。

3. 複合的な座標計算の鍵となる定数
カメラのズームターゲットを計算するロジックは、グローバル座標系とローカル座標系の情報を組み合わせて行われます。このための重要な定数が**src/utils/constants.ts**に定義されています（リファクタリング済み）。

定数	意味	使用箇所
BOOKSHELF_MODEL_Y_CENTER	3Dモデルとして配置された本棚のY軸方向の中心グローバル座標。この値を基準に、カメラのターゲットY座標が決定されます。	constants.ts, CameraFocus.tsx
BOOKSHELF_OFFSETS	App.tsxで各本棚に設定されたグローバル座標（X, Y, Z）をまとめたマップ。キーはIDオフセット（例: 1000, 2000...）です。	constants.ts, CameraFocus.tsx
ZOOM_OFFSET_X	ズームイン時、カメラが本のターゲット位置からどれだけ離れるかを定義するX軸方向の距離。	constants.ts, CameraFocus.tsx

4. 本のID設計（データと位置の連動）本のデータ (bookData.ts) は、そのIDの1000の位によって、どの本棚に属するかを定義し、これが座標計算と連携します。ID範囲offsetId (1000の位)対応する本棚位置 (BOOKSHELF_OFFSETS)1001 〜 19991000[-7.5, -5, 0]2001 〜 29992000[-7.5, -5, 10]3001 〜 39993000[7.5, -5, 0]4001 〜 49994000[7.5, -5, 10]

useCameraFocusStateフックは、クリックされた本のIDからこのoffsetIdを抽出し、CameraFocus.tsxが**BOOKSHELF_OFFSETS**を参照して、カメラのターゲットグローバル座標を決定します。

これにより、データIDと3D空間上の物理的な位置が厳密に連動しています。